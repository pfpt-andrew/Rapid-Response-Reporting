"Mitigation Name","data source","technique","Software Name","Software Description","Mitigation Description","Application","TID","Use","tactic"
"Audit","loaded dlls","dll side-loading","BBSRAT","[BBSRAT](https://attack.mitre.org/software/S0127) is malware with remote access tool functionality that has been used in targeted compromises. (Citation: Palo Alto Networks BBSRAT)","Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.","Use the program sxstrace.exe that is included with Windows along with manual inspection to check manifest files for side-loading vulnerabilities in software.","T1073","DLL side-loading has been used to execute [BBSRAT](https://attack.mitre.org/software/S0127) through a legitimate Citrix executable, ssonsvr.exe. The Citrix executable was dropped along with [BBSRAT](https://attack.mitre.org/software/S0127) by the dropper.","defense-evasion"
"Network Intrusion Prevention","binary file metadata","data compressed","BBSRAT","[BBSRAT](https://attack.mitre.org/software/S0127) is malware with remote access tool functionality that has been used in targeted compromises. (Citation: Palo Alto Networks BBSRAT)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion prevention or data loss prevention tools may be set to block specific file types from leaving the network over unencrypted channels. An adversary may move to an encrypted channel or use other mechanisms of encapsulating the traffic in these situations.","T1002","[BBSRAT](https://attack.mitre.org/software/S0127) can compress data with ZLIB prior to sending it back to the C2 server.","exfiltration"
"Network Intrusion Prevention","malware reverse engineering","custom cryptographic protocol","BBSRAT","[BBSRAT](https://attack.mitre.org/software/S0127) is malware with remote access tool functionality that has been used in targeted compromises. (Citation: Palo Alto Networks BBSRAT)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Since the custom protocol used may not adhere to typical protocol standards, there may be opportunities to signature the traffic on a network level for detection. Signatures are often for unique indicators within protocols and may be based on the specific protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.","T1024","[BBSRAT](https://attack.mitre.org/software/S0127) uses a custom encryption algorithm on data sent back to the C2 server over HTTP.","command-and-control"
"Network Intrusion Prevention","malware reverse engineering","standard application layer protocol","BBSRAT","[BBSRAT](https://attack.mitre.org/software/S0127) is malware with remote access tool functionality that has been used in targeted compromises. (Citation: Palo Alto Networks BBSRAT)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.","T1071","[BBSRAT](https://attack.mitre.org/software/S0127) uses GET and POST requests over HTTP or HTTPS for command and control to obtain commands and send ZLIB compressed data back to the C2 server.","command-and-control"
"Network Intrusion Prevention","netflow/enclave netflow","commonly used port","BBSRAT","[BBSRAT](https://attack.mitre.org/software/S0127) is malware with remote access tool functionality that has been used in targeted compromises. (Citation: Palo Alto Networks BBSRAT)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.","T1043","[BBSRAT](https://attack.mitre.org/software/S0127) uses HTTP TCP port 80 and HTTPS TCP port 443 for communications.","command-and-control"
"Network Intrusion Prevention","netflow/enclave netflow","custom cryptographic protocol","BBSRAT","[BBSRAT](https://attack.mitre.org/software/S0127) is malware with remote access tool functionality that has been used in targeted compromises. (Citation: Palo Alto Networks BBSRAT)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Since the custom protocol used may not adhere to typical protocol standards, there may be opportunities to signature the traffic on a network level for detection. Signatures are often for unique indicators within protocols and may be based on the specific protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.","T1024","[BBSRAT](https://attack.mitre.org/software/S0127) uses a custom encryption algorithm on data sent back to the C2 server over HTTP.","command-and-control"
"Network Intrusion Prevention","netflow/enclave netflow","standard application layer protocol","BBSRAT","[BBSRAT](https://attack.mitre.org/software/S0127) is malware with remote access tool functionality that has been used in targeted compromises. (Citation: Palo Alto Networks BBSRAT)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.","T1071","[BBSRAT](https://attack.mitre.org/software/S0127) uses GET and POST requests over HTTP or HTTPS for command and control to obtain commands and send ZLIB compressed data back to the C2 server.","command-and-control"
"Network Segmentation","netflow/enclave netflow","commonly used port","BBSRAT","[BBSRAT](https://attack.mitre.org/software/S0127) is malware with remote access tool functionality that has been used in targeted compromises. (Citation: Palo Alto Networks BBSRAT)","Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network.","Configure internal and external firewalls to block traffic using common ports that associate to network protocols that may be unnecessary for that particular network segment.","T1043","[BBSRAT](https://attack.mitre.org/software/S0127) uses HTTP TCP port 80 and HTTPS TCP port 443 for communications.","command-and-control"
"Restrict File and Directory Permissions","loaded dlls","dll side-loading","BBSRAT","[BBSRAT](https://attack.mitre.org/software/S0127) is malware with remote access tool functionality that has been used in targeted compromises. (Citation: Palo Alto Networks BBSRAT)","Restrict access by setting directory and file permissions that are not specific to users or privileged accounts.","Install software in write-protected locations.","T1073","DLL side-loading has been used to execute [BBSRAT](https://attack.mitre.org/software/S0127) through a legitimate Citrix executable, ssonsvr.exe. The Citrix executable was dropped along with [BBSRAT](https://attack.mitre.org/software/S0127) by the dropper.","defense-evasion"
"Update Software","loaded dlls","dll side-loading","BBSRAT","[BBSRAT](https://attack.mitre.org/software/S0127) is malware with remote access tool functionality that has been used in targeted compromises. (Citation: Palo Alto Networks BBSRAT)","Perform regular software updates to mitigate exploitation risk.","Update software regularly to include patches that fix DLL side-loading vulnerabilities.","T1073","DLL side-loading has been used to execute [BBSRAT](https://attack.mitre.org/software/S0127) through a legitimate Citrix executable, ssonsvr.exe. The Citrix executable was dropped along with [BBSRAT](https://attack.mitre.org/software/S0127) by the dropper.","defense-evasion"
