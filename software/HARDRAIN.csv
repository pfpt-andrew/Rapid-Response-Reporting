"Mitigation Name","data source","technique","Software Name","Software Description","Mitigation Description","Application","TID","Use","tactic"
"Network Intrusion Prevention","malware reverse engineering","custom cryptographic protocol","HARDRAIN","[HARDRAIN](https://attack.mitre.org/software/S0246) is a Trojan malware variant reportedly used by the North Korean government. (Citation: US-CERT HARDRAIN March 2018)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Since the custom protocol used may not adhere to typical protocol standards, there may be opportunities to signature the traffic on a network level for detection. Signatures are often for unique indicators within protocols and may be based on the specific protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.","T1024","[HARDRAIN](https://attack.mitre.org/software/S0246) uses FakeTLS to communicate with its C2 server.","command-and-control"
"Network Intrusion Prevention","netflow/enclave netflow","commonly used port","HARDRAIN","[HARDRAIN](https://attack.mitre.org/software/S0246) is a Trojan malware variant reportedly used by the North Korean government. (Citation: US-CERT HARDRAIN March 2018)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.","T1043","[HARDRAIN](https://attack.mitre.org/software/S0246) binds and listens on port 443.","command-and-control"
"Network Intrusion Prevention","netflow/enclave netflow","connection proxy","HARDRAIN","[HARDRAIN](https://attack.mitre.org/software/S0246) is a Trojan malware variant reportedly used by the North Korean government. (Citation: US-CERT HARDRAIN March 2018)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific C2 protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.","T1090","[HARDRAIN](https://attack.mitre.org/software/S0246) uses the command <code>cmd.exe /c netsh firewall add portopening TCP 443 ""adp""</code> and makes the victim machine function as a proxy server.","command-and-control"
"Network Intrusion Prevention","netflow/enclave netflow","connection proxy","HARDRAIN","[HARDRAIN](https://attack.mitre.org/software/S0246) is a Trojan malware variant reportedly used by the North Korean government. (Citation: US-CERT HARDRAIN March 2018)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific C2 protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.","T1090","[HARDRAIN](https://attack.mitre.org/software/S0246) uses the command <code>cmd.exe /c netsh firewall add portopening TCP 443 ""adp""</code> and makes the victim machine function as a proxy server.","defense-evasion"
"Network Intrusion Prevention","netflow/enclave netflow","custom cryptographic protocol","HARDRAIN","[HARDRAIN](https://attack.mitre.org/software/S0246) is a Trojan malware variant reportedly used by the North Korean government. (Citation: US-CERT HARDRAIN March 2018)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Since the custom protocol used may not adhere to typical protocol standards, there may be opportunities to signature the traffic on a network level for detection. Signatures are often for unique indicators within protocols and may be based on the specific protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.","T1024","[HARDRAIN](https://attack.mitre.org/software/S0246) uses FakeTLS to communicate with its C2 server.","command-and-control"
"Network Segmentation","netflow/enclave netflow","commonly used port","HARDRAIN","[HARDRAIN](https://attack.mitre.org/software/S0246) is a Trojan malware variant reportedly used by the North Korean government. (Citation: US-CERT HARDRAIN March 2018)","Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network.","Configure internal and external firewalls to block traffic using common ports that associate to network protocols that may be unnecessary for that particular network segment.","T1043","[HARDRAIN](https://attack.mitre.org/software/S0246) binds and listens on port 443.","command-and-control"
"Restrict File and Directory Permissions","anti-virus","disabling security tools","HARDRAIN","[HARDRAIN](https://attack.mitre.org/software/S0246) is a Trojan malware variant reportedly used by the North Korean government. (Citation: US-CERT HARDRAIN March 2018)","Restrict access by setting directory and file permissions that are not specific to users or privileged accounts.","Ensure proper process, Registry, and file permissions are in place to prevent adversaries from disabling or interfering with security services.","T1089","[HARDRAIN](https://attack.mitre.org/software/S0246) opens the Windows Firewall to modify incoming connections.","defense-evasion"
"User Account Management","anti-virus","disabling security tools","HARDRAIN","[HARDRAIN](https://attack.mitre.org/software/S0246) is a Trojan malware variant reportedly used by the North Korean government. (Citation: US-CERT HARDRAIN March 2018)","Manage the creation, modification, use, and permissions associated to user accounts.","Ensure proper user permissions are in place to prevent adversaries from disabling or interfering with security services.","T1089","[HARDRAIN](https://attack.mitre.org/software/S0246) opens the Windows Firewall to modify incoming connections.","defense-evasion"
