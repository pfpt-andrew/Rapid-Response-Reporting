"Mitigation Name","data source","technique","Software Name","Software Description","Mitigation Description","Application","TID","Use","tactic"
"Antivirus/Antimalware","binary file metadata","obfuscated files or information","POSHSPY","[POSHSPY](https://attack.mitre.org/software/S0150) is a backdoor that has been used by [APT29](https://attack.mitre.org/groups/G0016) since at least 2015. It appears to be used as a secondary backdoor used if the actors lost access to their primary backdoors. (Citation: FireEye POSHSPY April 2017)","Use signatures or heuristics to detect malicious software.","Consider utilizing the Antimalware Scan Interface (AMSI) on Windows 10 to analyze commands after being processed/interpreted.","T1027","[POSHSPY](https://attack.mitre.org/software/S0150) appends a file signature header (randomly selected from six file types) to encrypted data prior to upload or download.","defense-evasion"
"Antivirus/Antimalware","malware reverse engineering","obfuscated files or information","POSHSPY","[POSHSPY](https://attack.mitre.org/software/S0150) is a backdoor that has been used by [APT29](https://attack.mitre.org/groups/G0016) since at least 2015. It appears to be used as a secondary backdoor used if the actors lost access to their primary backdoors. (Citation: FireEye POSHSPY April 2017)","Use signatures or heuristics to detect malicious software.","Consider utilizing the Antimalware Scan Interface (AMSI) on Windows 10 to analyze commands after being processed/interpreted.","T1027","[POSHSPY](https://attack.mitre.org/software/S0150) appends a file signature header (randomly selected from six file types) to encrypted data prior to upload or download.","defense-evasion"
"Antivirus/Antimalware","network intrusion detection system","obfuscated files or information","POSHSPY","[POSHSPY](https://attack.mitre.org/software/S0150) is a backdoor that has been used by [APT29](https://attack.mitre.org/groups/G0016) since at least 2015. It appears to be used as a secondary backdoor used if the actors lost access to their primary backdoors. (Citation: FireEye POSHSPY April 2017)","Use signatures or heuristics to detect malicious software.","Consider utilizing the Antimalware Scan Interface (AMSI) on Windows 10 to analyze commands after being processed/interpreted.","T1027","[POSHSPY](https://attack.mitre.org/software/S0150) appends a file signature header (randomly selected from six file types) to encrypted data prior to upload or download.","defense-evasion"
"Antivirus/Antimalware","network protocol analysis","obfuscated files or information","POSHSPY","[POSHSPY](https://attack.mitre.org/software/S0150) is a backdoor that has been used by [APT29](https://attack.mitre.org/groups/G0016) since at least 2015. It appears to be used as a secondary backdoor used if the actors lost access to their primary backdoors. (Citation: FireEye POSHSPY April 2017)","Use signatures or heuristics to detect malicious software.","Consider utilizing the Antimalware Scan Interface (AMSI) on Windows 10 to analyze commands after being processed/interpreted.","T1027","[POSHSPY](https://attack.mitre.org/software/S0150) appends a file signature header (randomly selected from six file types) to encrypted data prior to upload or download.","defense-evasion"
"Antivirus/Antimalware","ssl/tls inspection","obfuscated files or information","POSHSPY","[POSHSPY](https://attack.mitre.org/software/S0150) is a backdoor that has been used by [APT29](https://attack.mitre.org/groups/G0016) since at least 2015. It appears to be used as a secondary backdoor used if the actors lost access to their primary backdoors. (Citation: FireEye POSHSPY April 2017)","Use signatures or heuristics to detect malicious software.","Consider utilizing the Antimalware Scan Interface (AMSI) on Windows 10 to analyze commands after being processed/interpreted.","T1027","[POSHSPY](https://attack.mitre.org/software/S0150) appends a file signature header (randomly selected from six file types) to encrypted data prior to upload or download.","defense-evasion"
"Antivirus/Antimalware","windows event logs","obfuscated files or information","POSHSPY","[POSHSPY](https://attack.mitre.org/software/S0150) is a backdoor that has been used by [APT29](https://attack.mitre.org/groups/G0016) since at least 2015. It appears to be used as a secondary backdoor used if the actors lost access to their primary backdoors. (Citation: FireEye POSHSPY April 2017)","Use signatures or heuristics to detect malicious software.","Consider utilizing the Antimalware Scan Interface (AMSI) on Windows 10 to analyze commands after being processed/interpreted.","T1027","[POSHSPY](https://attack.mitre.org/software/S0150) appends a file signature header (randomly selected from six file types) to encrypted data prior to upload or download.","defense-evasion"
"Code Signing","dll monitoring","powershell","POSHSPY","[POSHSPY](https://attack.mitre.org/software/S0150) is a backdoor that has been used by [APT29](https://attack.mitre.org/groups/G0016) since at least 2015. It appears to be used as a secondary backdoor used if the actors lost access to their primary backdoors. (Citation: FireEye POSHSPY April 2017)","Enforce binary and application integrity with digital signature verification to prevent untrusted code from executing.","Set PowerShell execution policy to execute only signed scripts.","T1086","[POSHSPY](https://attack.mitre.org/software/S0150) uses PowerShell to execute various commands, one to execute its payload.","execution"
"Code Signing","loaded dlls","powershell","POSHSPY","[POSHSPY](https://attack.mitre.org/software/S0150) is a backdoor that has been used by [APT29](https://attack.mitre.org/groups/G0016) since at least 2015. It appears to be used as a secondary backdoor used if the actors lost access to their primary backdoors. (Citation: FireEye POSHSPY April 2017)","Enforce binary and application integrity with digital signature verification to prevent untrusted code from executing.","Set PowerShell execution policy to execute only signed scripts.","T1086","[POSHSPY](https://attack.mitre.org/software/S0150) uses PowerShell to execute various commands, one to execute its payload.","execution"
"Disable or Remove Feature or Program","dll monitoring","powershell","POSHSPY","[POSHSPY](https://attack.mitre.org/software/S0150) is a backdoor that has been used by [APT29](https://attack.mitre.org/groups/G0016) since at least 2015. It appears to be used as a secondary backdoor used if the actors lost access to their primary backdoors. (Citation: FireEye POSHSPY April 2017)","Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.","It may be possible to remove PowerShell from systems when not needed, but a review should be performed to assess the impact to an environment, since it could be in use for many legitimate purposes and administrative functions.\\n\\nDisable/restrict the WinRM Service to help prevent uses of PowerShell for remote execution.","T1086","[POSHSPY](https://attack.mitre.org/software/S0150) uses PowerShell to execute various commands, one to execute its payload.","execution"
"Disable or Remove Feature or Program","loaded dlls","powershell","POSHSPY","[POSHSPY](https://attack.mitre.org/software/S0150) is a backdoor that has been used by [APT29](https://attack.mitre.org/groups/G0016) since at least 2015. It appears to be used as a secondary backdoor used if the actors lost access to their primary backdoors. (Citation: FireEye POSHSPY April 2017)","Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.","It may be possible to remove PowerShell from systems when not needed, but a review should be performed to assess the impact to an environment, since it could be in use for many legitimate purposes and administrative functions.\\n\\nDisable/restrict the WinRM Service to help prevent uses of PowerShell for remote execution.","T1086","[POSHSPY](https://attack.mitre.org/software/S0150) uses PowerShell to execute various commands, one to execute its payload.","execution"
"Network Intrusion Prevention","malware reverse engineering","standard cryptographic protocol","POSHSPY","[POSHSPY](https://attack.mitre.org/software/S0150) is a backdoor that has been used by [APT29](https://attack.mitre.org/groups/G0016) since at least 2015. It appears to be used as a secondary backdoor used if the actors lost access to their primary backdoors. (Citation: FireEye POSHSPY April 2017)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.","T1032","[POSHSPY](https://attack.mitre.org/software/S0150) encrypts C2 traffic with AES and RSA.","command-and-control"
"Network Intrusion Prevention","netflow/enclave netflow","data transfer size limits","POSHSPY","[POSHSPY](https://attack.mitre.org/software/S0150) is a backdoor that has been used by [APT29](https://attack.mitre.org/groups/G0016) since at least 2015. It appears to be used as a secondary backdoor used if the actors lost access to their primary backdoors. (Citation: FireEye POSHSPY April 2017)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary command and control infrastructure and malware can be used to mitigate activity at the network level.","T1030","[POSHSPY](https://attack.mitre.org/software/S0150) uploads data in 2048-byte chunks.","exfiltration"
"Network Intrusion Prevention","netflow/enclave netflow","domain generation algorithms","POSHSPY","[POSHSPY](https://attack.mitre.org/software/S0150) is a backdoor that has been used by [APT29](https://attack.mitre.org/groups/G0016) since at least 2015. It appears to be used as a secondary backdoor used if the actors lost access to their primary backdoors. (Citation: FireEye POSHSPY April 2017)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Malware researchers can reverse engineer malware variants that use DGAs and determine future domains that the malware will attempt to contact, but this is a time and resource intensive effort. Malware is also increasingly incorporating seed values that can be unique for each instance, which would then need to be determined to extract future generated domains. In some cases, the seed that a particular sample uses can be extracted from DNS traffic. Even so, there can be thousands of possible domains generated per day; this makes it impractical for defenders to preemptively register all possible C2 domains due to the cost.","T1483","[POSHSPY](https://attack.mitre.org/software/S0150) uses a DGA to derive command and control URLs from a word list.","command-and-control"
"Network Intrusion Prevention","netflow/enclave netflow","remote file copy","POSHSPY","[POSHSPY](https://attack.mitre.org/software/S0150) is a backdoor that has been used by [APT29](https://attack.mitre.org/groups/G0016) since at least 2015. It appears to be used as a secondary backdoor used if the actors lost access to their primary backdoors. (Citation: FireEye POSHSPY April 2017)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware or unusual data transfer over known tools and protocols like FTP can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.","T1105","[POSHSPY](https://attack.mitre.org/software/S0150) downloads and executes additional PowerShell code and Windows binaries.","command-and-control"
"Network Intrusion Prevention","netflow/enclave netflow","remote file copy","POSHSPY","[POSHSPY](https://attack.mitre.org/software/S0150) is a backdoor that has been used by [APT29](https://attack.mitre.org/groups/G0016) since at least 2015. It appears to be used as a secondary backdoor used if the actors lost access to their primary backdoors. (Citation: FireEye POSHSPY April 2017)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware or unusual data transfer over known tools and protocols like FTP can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.","T1105","[POSHSPY](https://attack.mitre.org/software/S0150) downloads and executes additional PowerShell code and Windows binaries.","lateral-movement"
"Network Intrusion Prevention","netflow/enclave netflow","standard cryptographic protocol","POSHSPY","[POSHSPY](https://attack.mitre.org/software/S0150) is a backdoor that has been used by [APT29](https://attack.mitre.org/groups/G0016) since at least 2015. It appears to be used as a secondary backdoor used if the actors lost access to their primary backdoors. (Citation: FireEye POSHSPY April 2017)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.","T1032","[POSHSPY](https://attack.mitre.org/software/S0150) encrypts C2 traffic with AES and RSA.","command-and-control"
"Network Intrusion Prevention","network protocol analysis","remote file copy","POSHSPY","[POSHSPY](https://attack.mitre.org/software/S0150) is a backdoor that has been used by [APT29](https://attack.mitre.org/groups/G0016) since at least 2015. It appears to be used as a secondary backdoor used if the actors lost access to their primary backdoors. (Citation: FireEye POSHSPY April 2017)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware or unusual data transfer over known tools and protocols like FTP can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.","T1105","[POSHSPY](https://attack.mitre.org/software/S0150) downloads and executes additional PowerShell code and Windows binaries.","command-and-control"
"Network Intrusion Prevention","network protocol analysis","remote file copy","POSHSPY","[POSHSPY](https://attack.mitre.org/software/S0150) is a backdoor that has been used by [APT29](https://attack.mitre.org/groups/G0016) since at least 2015. It appears to be used as a secondary backdoor used if the actors lost access to their primary backdoors. (Citation: FireEye POSHSPY April 2017)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware or unusual data transfer over known tools and protocols like FTP can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.","T1105","[POSHSPY](https://attack.mitre.org/software/S0150) downloads and executes additional PowerShell code and Windows binaries.","lateral-movement"
"Network Intrusion Prevention","ssl/tls inspection","standard cryptographic protocol","POSHSPY","[POSHSPY](https://attack.mitre.org/software/S0150) is a backdoor that has been used by [APT29](https://attack.mitre.org/groups/G0016) since at least 2015. It appears to be used as a secondary backdoor used if the actors lost access to their primary backdoors. (Citation: FireEye POSHSPY April 2017)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.","T1032","[POSHSPY](https://attack.mitre.org/software/S0150) encrypts C2 traffic with AES and RSA.","command-and-control"
"Privileged Account Management","dll monitoring","powershell","POSHSPY","[POSHSPY](https://attack.mitre.org/software/S0150) is a backdoor that has been used by [APT29](https://attack.mitre.org/groups/G0016) since at least 2015. It appears to be used as a secondary backdoor used if the actors lost access to their primary backdoors. (Citation: FireEye POSHSPY April 2017)","Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","When PowerShell is necessary, restrict PowerShell execution policy to administrators. Be aware that there are methods of bypassing the PowerShell execution policy, depending on environment configuration.","T1086","[POSHSPY](https://attack.mitre.org/software/S0150) uses PowerShell to execute various commands, one to execute its payload.","execution"
"Privileged Account Management","loaded dlls","powershell","POSHSPY","[POSHSPY](https://attack.mitre.org/software/S0150) is a backdoor that has been used by [APT29](https://attack.mitre.org/groups/G0016) since at least 2015. It appears to be used as a secondary backdoor used if the actors lost access to their primary backdoors. (Citation: FireEye POSHSPY April 2017)","Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","When PowerShell is necessary, restrict PowerShell execution policy to administrators. Be aware that there are methods of bypassing the PowerShell execution policy, depending on environment configuration.","T1086","[POSHSPY](https://attack.mitre.org/software/S0150) uses PowerShell to execute various commands, one to execute its payload.","execution"
"Restrict Web-Based Content","netflow/enclave netflow","domain generation algorithms","POSHSPY","[POSHSPY](https://attack.mitre.org/software/S0150) is a backdoor that has been used by [APT29](https://attack.mitre.org/groups/G0016) since at least 2015. It appears to be used as a secondary backdoor used if the actors lost access to their primary backdoors. (Citation: FireEye POSHSPY April 2017)","Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.","In some cases a local DNS sinkhole may be used to help prevent DGA-based command and control at a reduced cost.","T1483","[POSHSPY](https://attack.mitre.org/software/S0150) uses a DGA to derive command and control URLs from a word list.","command-and-control"
"SSL/TLS Inspection","malware reverse engineering","standard cryptographic protocol","POSHSPY","[POSHSPY](https://attack.mitre.org/software/S0150) is a backdoor that has been used by [APT29](https://attack.mitre.org/groups/G0016) since at least 2015. It appears to be used as a secondary backdoor used if the actors lost access to their primary backdoors. (Citation: FireEye POSHSPY April 2017)","Break and inspect SSL/TLS sessions to look at encrypted web traffic for adversary activity.","SSL/TLS inspection can be used to see the contents of encrypted sessions to look for network-based indicators of malware communication protocols.","T1032","[POSHSPY](https://attack.mitre.org/software/S0150) encrypts C2 traffic with AES and RSA.","command-and-control"
"SSL/TLS Inspection","netflow/enclave netflow","standard cryptographic protocol","POSHSPY","[POSHSPY](https://attack.mitre.org/software/S0150) is a backdoor that has been used by [APT29](https://attack.mitre.org/groups/G0016) since at least 2015. It appears to be used as a secondary backdoor used if the actors lost access to their primary backdoors. (Citation: FireEye POSHSPY April 2017)","Break and inspect SSL/TLS sessions to look at encrypted web traffic for adversary activity.","SSL/TLS inspection can be used to see the contents of encrypted sessions to look for network-based indicators of malware communication protocols.","T1032","[POSHSPY](https://attack.mitre.org/software/S0150) encrypts C2 traffic with AES and RSA.","command-and-control"
"SSL/TLS Inspection","ssl/tls inspection","standard cryptographic protocol","POSHSPY","[POSHSPY](https://attack.mitre.org/software/S0150) is a backdoor that has been used by [APT29](https://attack.mitre.org/groups/G0016) since at least 2015. It appears to be used as a secondary backdoor used if the actors lost access to their primary backdoors. (Citation: FireEye POSHSPY April 2017)","Break and inspect SSL/TLS sessions to look at encrypted web traffic for adversary activity.","SSL/TLS inspection can be used to see the contents of encrypted sessions to look for network-based indicators of malware communication protocols.","T1032","[POSHSPY](https://attack.mitre.org/software/S0150) encrypts C2 traffic with AES and RSA.","command-and-control"
