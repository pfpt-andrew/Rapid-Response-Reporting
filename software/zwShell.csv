"Mitigation Name","data source","technique","Software Name","Software Description","Mitigation Description","Application","TID","Use","tactic"
"Audit","netflow/enclave netflow","remote desktop protocol","zwShell","[zwShell](https://attack.mitre.org/software/S0350) is a remote access tool (RAT) written in Delphi that has been used by [Night Dragon](https://attack.mitre.org/groups/G0014).(Citation: McAfee Night Dragon)","Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.","Audit the Remote Desktop Users group membership regularly. Remove unnecessary accounts and groups from Remote Desktop Users groups","T1076","[zwShell](https://attack.mitre.org/software/S0350) has used RDP for lateral movement.","lateral-movement"
"Audit","windows event logs","scheduled task","zwShell","[zwShell](https://attack.mitre.org/software/S0350) is a remote access tool (RAT) written in Delphi that has been used by [Night Dragon](https://attack.mitre.org/groups/G0014).(Citation: McAfee Night Dragon)","Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.","Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for permission weaknesses in scheduled tasks that could be used to escalate privileges.","T1053","[zwShell](https://attack.mitre.org/software/S0350) has used SchTasks for execution.","execution"
"Audit","windows event logs","scheduled task","zwShell","[zwShell](https://attack.mitre.org/software/S0350) is a remote access tool (RAT) written in Delphi that has been used by [Night Dragon](https://attack.mitre.org/groups/G0014).(Citation: McAfee Night Dragon)","Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.","Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for permission weaknesses in scheduled tasks that could be used to escalate privileges.","T1053","[zwShell](https://attack.mitre.org/software/S0350) has used SchTasks for execution.","persistence"
"Audit","windows event logs","scheduled task","zwShell","[zwShell](https://attack.mitre.org/software/S0350) is a remote access tool (RAT) written in Delphi that has been used by [Night Dragon](https://attack.mitre.org/groups/G0014).(Citation: McAfee Night Dragon)","Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.","Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for permission weaknesses in scheduled tasks that could be used to escalate privileges.","T1053","[zwShell](https://attack.mitre.org/software/S0350) has used SchTasks for execution.","privilege-escalation"
"Disable or Remove Feature or Program","netflow/enclave netflow","remote desktop protocol","zwShell","[zwShell](https://attack.mitre.org/software/S0350) is a remote access tool (RAT) written in Delphi that has been used by [Night Dragon](https://attack.mitre.org/groups/G0014).(Citation: McAfee Night Dragon)","Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.","Disable the RDP service if it is unnecessary.","T1076","[zwShell](https://attack.mitre.org/software/S0350) has used RDP for lateral movement.","lateral-movement"
"Limit Access to Resource Over Network","netflow/enclave netflow","remote desktop protocol","zwShell","[zwShell](https://attack.mitre.org/software/S0350) is a remote access tool (RAT) written in Delphi that has been used by [Night Dragon](https://attack.mitre.org/groups/G0014).(Citation: McAfee Night Dragon)","Prevent access to file shares, remote access to systems, unnecessary services. Mechanisms to limit access may include use of network concentrators, RDP gateways, etc.","Use remote desktop gateways.","T1076","[zwShell](https://attack.mitre.org/software/S0350) has used RDP for lateral movement.","lateral-movement"
"Multi-factor Authentication","netflow/enclave netflow","remote desktop protocol","zwShell","[zwShell](https://attack.mitre.org/software/S0350) is a remote access tool (RAT) written in Delphi that has been used by [Night Dragon](https://attack.mitre.org/groups/G0014).(Citation: McAfee Night Dragon)","Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.","Use multi-factor authentication for remote logins.","T1076","[zwShell](https://attack.mitre.org/software/S0350) has used RDP for lateral movement.","lateral-movement"
"Network Segmentation","netflow/enclave netflow","remote desktop protocol","zwShell","[zwShell](https://attack.mitre.org/software/S0350) is a remote access tool (RAT) written in Delphi that has been used by [Night Dragon](https://attack.mitre.org/groups/G0014).(Citation: McAfee Night Dragon)","Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network.","Do not leave RDP accessible from the internet. Enable firewall rules to block RDP traffic between network security zones within a network.","T1076","[zwShell](https://attack.mitre.org/software/S0350) has used RDP for lateral movement.","lateral-movement"
"Operating System Configuration","netflow/enclave netflow","remote desktop protocol","zwShell","[zwShell](https://attack.mitre.org/software/S0350) is a remote access tool (RAT) written in Delphi that has been used by [Night Dragon](https://attack.mitre.org/groups/G0014).(Citation: McAfee Night Dragon)","Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.","Change GPOs to define shorter timeouts sessions and maximum amount of time any single session can be active. Change GPOs to specify the maximum amount of time that a disconnected session stays active on the RD session host server.","T1076","[zwShell](https://attack.mitre.org/software/S0350) has used RDP for lateral movement.","lateral-movement"
"Operating System Configuration","windows event logs","scheduled task","zwShell","[zwShell](https://attack.mitre.org/software/S0350) is a remote access tool (RAT) written in Delphi that has been used by [Night Dragon](https://attack.mitre.org/groups/G0014).(Citation: McAfee Night Dragon)","Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.","Configure settings for scheduled tasks to force tasks to run under the context of the authenticated account instead of allowing them to run as SYSTEM. The associated Registry key is located at <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\SubmitControl</code>. The setting can be configured through GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > Security Options: Domain Controller: Allow server operators to schedule tasks, set to disabled.","T1053","[zwShell](https://attack.mitre.org/software/S0350) has used SchTasks for execution.","execution"
"Operating System Configuration","windows event logs","scheduled task","zwShell","[zwShell](https://attack.mitre.org/software/S0350) is a remote access tool (RAT) written in Delphi that has been used by [Night Dragon](https://attack.mitre.org/groups/G0014).(Citation: McAfee Night Dragon)","Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.","Configure settings for scheduled tasks to force tasks to run under the context of the authenticated account instead of allowing them to run as SYSTEM. The associated Registry key is located at <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\SubmitControl</code>. The setting can be configured through GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > Security Options: Domain Controller: Allow server operators to schedule tasks, set to disabled.","T1053","[zwShell](https://attack.mitre.org/software/S0350) has used SchTasks for execution.","persistence"
"Operating System Configuration","windows event logs","scheduled task","zwShell","[zwShell](https://attack.mitre.org/software/S0350) is a remote access tool (RAT) written in Delphi that has been used by [Night Dragon](https://attack.mitre.org/groups/G0014).(Citation: McAfee Night Dragon)","Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.","Configure settings for scheduled tasks to force tasks to run under the context of the authenticated account instead of allowing them to run as SYSTEM. The associated Registry key is located at <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\SubmitControl</code>. The setting can be configured through GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > Security Options: Domain Controller: Allow server operators to schedule tasks, set to disabled.","T1053","[zwShell](https://attack.mitre.org/software/S0350) has used SchTasks for execution.","privilege-escalation"
"Privileged Account Management","netflow/enclave netflow","remote desktop protocol","zwShell","[zwShell](https://attack.mitre.org/software/S0350) is a remote access tool (RAT) written in Delphi that has been used by [Night Dragon](https://attack.mitre.org/groups/G0014).(Citation: McAfee Night Dragon)","Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","Consider removing the local Administrators group from the list of groups allowed to log in through RDP.","T1076","[zwShell](https://attack.mitre.org/software/S0350) has used RDP for lateral movement.","lateral-movement"
"Privileged Account Management","windows event logs","scheduled task","zwShell","[zwShell](https://attack.mitre.org/software/S0350) is a remote access tool (RAT) written in Delphi that has been used by [Night Dragon](https://attack.mitre.org/groups/G0014).(Citation: McAfee Night Dragon)","Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","Configure the Increase Scheduling Priority option to only allow the Administrators group the rights to schedule a priority process. This can be can be configured through GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Increase scheduling priority.","T1053","[zwShell](https://attack.mitre.org/software/S0350) has used SchTasks for execution.","execution"
"Privileged Account Management","windows event logs","scheduled task","zwShell","[zwShell](https://attack.mitre.org/software/S0350) is a remote access tool (RAT) written in Delphi that has been used by [Night Dragon](https://attack.mitre.org/groups/G0014).(Citation: McAfee Night Dragon)","Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","Configure the Increase Scheduling Priority option to only allow the Administrators group the rights to schedule a priority process. This can be can be configured through GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Increase scheduling priority.","T1053","[zwShell](https://attack.mitre.org/software/S0350) has used SchTasks for execution.","persistence"
"Privileged Account Management","windows event logs","scheduled task","zwShell","[zwShell](https://attack.mitre.org/software/S0350) is a remote access tool (RAT) written in Delphi that has been used by [Night Dragon](https://attack.mitre.org/groups/G0014).(Citation: McAfee Night Dragon)","Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","Configure the Increase Scheduling Priority option to only allow the Administrators group the rights to schedule a priority process. This can be can be configured through GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Increase scheduling priority.","T1053","[zwShell](https://attack.mitre.org/software/S0350) has used SchTasks for execution.","privilege-escalation"
"Restrict Registry Permissions","windows event logs","modify registry","zwShell","[zwShell](https://attack.mitre.org/software/S0350) is a remote access tool (RAT) written in Delphi that has been used by [Night Dragon](https://attack.mitre.org/groups/G0014).(Citation: McAfee Night Dragon)","Restrict the ability to modify certain hives or keys in the Windows Registry.","Ensure proper permissions are set for Registry hives to prevent users from modifying keys for system components that may lead to privilege escalation.","T1112","[zwShell](https://attack.mitre.org/software/S0350) can modify the Registry.","defense-evasion"
"User Account Management","netflow/enclave netflow","remote desktop protocol","zwShell","[zwShell](https://attack.mitre.org/software/S0350) is a remote access tool (RAT) written in Delphi that has been used by [Night Dragon](https://attack.mitre.org/groups/G0014).(Citation: McAfee Night Dragon)","Manage the creation, modification, use, and permissions associated to user accounts.","Limit remote user permissions if remote access is necessary.","T1076","[zwShell](https://attack.mitre.org/software/S0350) has used RDP for lateral movement.","lateral-movement"
"User Account Management","windows event logs","new service","zwShell","[zwShell](https://attack.mitre.org/software/S0350) is a remote access tool (RAT) written in Delphi that has been used by [Night Dragon](https://attack.mitre.org/groups/G0014).(Citation: McAfee Night Dragon)","Manage the creation, modification, use, and permissions associated to user accounts.","Limit privileges of user accounts and remediate Privilege Escalation vectors so only  authorized administrators can create new services.","T1050","[zwShell](https://attack.mitre.org/software/S0350) has established persistence by adding itself as a new service.","persistence"
"User Account Management","windows event logs","new service","zwShell","[zwShell](https://attack.mitre.org/software/S0350) is a remote access tool (RAT) written in Delphi that has been used by [Night Dragon](https://attack.mitre.org/groups/G0014).(Citation: McAfee Night Dragon)","Manage the creation, modification, use, and permissions associated to user accounts.","Limit privileges of user accounts and remediate Privilege Escalation vectors so only  authorized administrators can create new services.","T1050","[zwShell](https://attack.mitre.org/software/S0350) has established persistence by adding itself as a new service.","privilege-escalation"
"User Account Management","windows event logs","scheduled task","zwShell","[zwShell](https://attack.mitre.org/software/S0350) is a remote access tool (RAT) written in Delphi that has been used by [Night Dragon](https://attack.mitre.org/groups/G0014).(Citation: McAfee Night Dragon)","Manage the creation, modification, use, and permissions associated to user accounts.","Limit privileges of user accounts and remediate Privilege Escalation vectors so only authorized administrators can create scheduled tasks on remote systems.","T1053","[zwShell](https://attack.mitre.org/software/S0350) has used SchTasks for execution.","execution"
"User Account Management","windows event logs","scheduled task","zwShell","[zwShell](https://attack.mitre.org/software/S0350) is a remote access tool (RAT) written in Delphi that has been used by [Night Dragon](https://attack.mitre.org/groups/G0014).(Citation: McAfee Night Dragon)","Manage the creation, modification, use, and permissions associated to user accounts.","Limit privileges of user accounts and remediate Privilege Escalation vectors so only authorized administrators can create scheduled tasks on remote systems.","T1053","[zwShell](https://attack.mitre.org/software/S0350) has used SchTasks for execution.","persistence"
"User Account Management","windows event logs","scheduled task","zwShell","[zwShell](https://attack.mitre.org/software/S0350) is a remote access tool (RAT) written in Delphi that has been used by [Night Dragon](https://attack.mitre.org/groups/G0014).(Citation: McAfee Night Dragon)","Manage the creation, modification, use, and permissions associated to user accounts.","Limit privileges of user accounts and remediate Privilege Escalation vectors so only authorized administrators can create scheduled tasks on remote systems.","T1053","[zwShell](https://attack.mitre.org/software/S0350) has used SchTasks for execution.","privilege-escalation"
