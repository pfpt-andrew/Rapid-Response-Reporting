"Mitigation Name","data source","technique","Software Name","Software Description","Mitigation Description","Application","TID","Use","tactic"
"Antivirus/Antimalware","binary file metadata","obfuscated files or information","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Use signatures or heuristics to detect malicious software.","Consider utilizing the Antimalware Scan Interface (AMSI) on Windows 10 to analyze commands after being processed/interpreted.","T1027","[POWERSTATS](https://attack.mitre.org/software/S0223) uses character replacement, [PowerShell](https://attack.mitre.org/techniques/T1086) environment variables, and XOR encoding to obfuscate code. [POWERSTATS](https://attack.mitre.org/software/S0223)'s backdoor code is a multi-layer obfuscated, encoded, and compressed blob.","defense-evasion"
"Antivirus/Antimalware","malware reverse engineering","obfuscated files or information","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Use signatures or heuristics to detect malicious software.","Consider utilizing the Antimalware Scan Interface (AMSI) on Windows 10 to analyze commands after being processed/interpreted.","T1027","[POWERSTATS](https://attack.mitre.org/software/S0223) uses character replacement, [PowerShell](https://attack.mitre.org/techniques/T1086) environment variables, and XOR encoding to obfuscate code. [POWERSTATS](https://attack.mitre.org/software/S0223)'s backdoor code is a multi-layer obfuscated, encoded, and compressed blob.","defense-evasion"
"Antivirus/Antimalware","network intrusion detection system","obfuscated files or information","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Use signatures or heuristics to detect malicious software.","Consider utilizing the Antimalware Scan Interface (AMSI) on Windows 10 to analyze commands after being processed/interpreted.","T1027","[POWERSTATS](https://attack.mitre.org/software/S0223) uses character replacement, [PowerShell](https://attack.mitre.org/techniques/T1086) environment variables, and XOR encoding to obfuscate code. [POWERSTATS](https://attack.mitre.org/software/S0223)'s backdoor code is a multi-layer obfuscated, encoded, and compressed blob.","defense-evasion"
"Antivirus/Antimalware","network protocol analysis","obfuscated files or information","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Use signatures or heuristics to detect malicious software.","Consider utilizing the Antimalware Scan Interface (AMSI) on Windows 10 to analyze commands after being processed/interpreted.","T1027","[POWERSTATS](https://attack.mitre.org/software/S0223) uses character replacement, [PowerShell](https://attack.mitre.org/techniques/T1086) environment variables, and XOR encoding to obfuscate code. [POWERSTATS](https://attack.mitre.org/software/S0223)'s backdoor code is a multi-layer obfuscated, encoded, and compressed blob.","defense-evasion"
"Antivirus/Antimalware","ssl/tls inspection","obfuscated files or information","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Use signatures or heuristics to detect malicious software.","Consider utilizing the Antimalware Scan Interface (AMSI) on Windows 10 to analyze commands after being processed/interpreted.","T1027","[POWERSTATS](https://attack.mitre.org/software/S0223) uses character replacement, [PowerShell](https://attack.mitre.org/techniques/T1086) environment variables, and XOR encoding to obfuscate code. [POWERSTATS](https://attack.mitre.org/software/S0223)'s backdoor code is a multi-layer obfuscated, encoded, and compressed blob.","defense-evasion"
"Antivirus/Antimalware","windows event logs","obfuscated files or information","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Use signatures or heuristics to detect malicious software.","Consider utilizing the Antimalware Scan Interface (AMSI) on Windows 10 to analyze commands after being processed/interpreted.","T1027","[POWERSTATS](https://attack.mitre.org/software/S0223) uses character replacement, [PowerShell](https://attack.mitre.org/techniques/T1086) environment variables, and XOR encoding to obfuscate code. [POWERSTATS](https://attack.mitre.org/software/S0223)'s backdoor code is a multi-layer obfuscated, encoded, and compressed blob.","defense-evasion"
"Application Isolation and Sandboxing","dll monitoring","component object model and distributed com","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Restrict execution of code to a virtual environment on or in transit to an endpoint system.","Ensure all COM alerts and Protected View are enabled.","T1175","[POWERSTATS](https://attack.mitre.org/software/S0223) can use DCOM (targeting the 127.0.0.1 loopback address) to execute additional payloads on compromised hosts.","execution"
"Application Isolation and Sandboxing","dll monitoring","component object model and distributed com","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Restrict execution of code to a virtual environment on or in transit to an endpoint system.","Ensure all COM alerts and Protected View are enabled.","T1175","[POWERSTATS](https://attack.mitre.org/software/S0223) can use DCOM (targeting the 127.0.0.1 loopback address) to execute additional payloads on compromised hosts.","lateral-movement"
"Application Isolation and Sandboxing","dll monitoring","dynamic data exchange","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Restrict execution of code to a virtual environment on or in transit to an endpoint system.","Ensure Protected View is enabled.","T1173","[POWERSTATS](https://attack.mitre.org/software/S0223) can use DDE to execute additional payloads on compromised hosts.","execution"
"Application Isolation and Sandboxing","windows event logs","component object model and distributed com","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Restrict execution of code to a virtual environment on or in transit to an endpoint system.","Ensure all COM alerts and Protected View are enabled.","T1175","[POWERSTATS](https://attack.mitre.org/software/S0223) can use DCOM (targeting the 127.0.0.1 loopback address) to execute additional payloads on compromised hosts.","execution"
"Application Isolation and Sandboxing","windows event logs","component object model and distributed com","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Restrict execution of code to a virtual environment on or in transit to an endpoint system.","Ensure all COM alerts and Protected View are enabled.","T1175","[POWERSTATS](https://attack.mitre.org/software/S0223) can use DCOM (targeting the 127.0.0.1 loopback address) to execute additional payloads on compromised hosts.","lateral-movement"
"Application Isolation and Sandboxing","windows event logs","dynamic data exchange","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Restrict execution of code to a virtual environment on or in transit to an endpoint system.","Ensure Protected View is enabled.","T1173","[POWERSTATS](https://attack.mitre.org/software/S0223) can use DDE to execute additional payloads on compromised hosts.","execution"
"Audit","windows event logs","scheduled task","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.","Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for permission weaknesses in scheduled tasks that could be used to escalate privileges.","T1053","[POWERSTATS](https://attack.mitre.org/software/S0223) has established persistence through a scheduled task using the command <code>???C:\Windows\system32\schtasks.exe??? /Create /F /SC DAILY /ST 12:00 /TN MicrosoftEdge /TR ???c:\Windows\system32\wscript.exe C:\Windows\temp\Windows.vbe???</code>.","execution"
"Audit","windows event logs","scheduled task","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.","Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for permission weaknesses in scheduled tasks that could be used to escalate privileges.","T1053","[POWERSTATS](https://attack.mitre.org/software/S0223) has established persistence through a scheduled task using the command <code>???C:\Windows\system32\schtasks.exe??? /Create /F /SC DAILY /ST 12:00 /TN MicrosoftEdge /TR ???c:\Windows\system32\wscript.exe C:\Windows\temp\Windows.vbe???</code>.","persistence"
"Audit","windows event logs","scheduled task","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.","Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for permission weaknesses in scheduled tasks that could be used to escalate privileges.","T1053","[POWERSTATS](https://attack.mitre.org/software/S0223) has established persistence through a scheduled task using the command <code>???C:\Windows\system32\schtasks.exe??? /Create /F /SC DAILY /ST 12:00 /TN MicrosoftEdge /TR ???c:\Windows\system32\wscript.exe C:\Windows\temp\Windows.vbe???</code>.","privilege-escalation"
"Behavior Prevention on Endpoint","dll monitoring","dynamic data exchange","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Use capabilities to prevent suspicious behavior patterns from occurring on endpoint systems. This could include suspicious process, file, API call, etc. behavior.","On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent DDE attacks and spawning of child processes from Office programs.","T1173","[POWERSTATS](https://attack.mitre.org/software/S0223) can use DDE to execute additional payloads on compromised hosts.","execution"
"Behavior Prevention on Endpoint","windows event logs","dynamic data exchange","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Use capabilities to prevent suspicious behavior patterns from occurring on endpoint systems. This could include suspicious process, file, API call, etc. behavior.","On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent DDE attacks and spawning of child processes from Office programs.","T1173","[POWERSTATS](https://attack.mitre.org/software/S0223) can use DDE to execute additional payloads on compromised hosts.","execution"
"Code Signing","binary file metadata","masquerading","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Enforce binary and application integrity with digital signature verification to prevent untrusted code from executing.","Require signed binaries.","T1036","[POWERSTATS](https://attack.mitre.org/software/S0223) has created a scheduled task named ""MicrosoftEdge"" to establish persistence.","defense-evasion"
"Code Signing","dll monitoring","powershell","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Enforce binary and application integrity with digital signature verification to prevent untrusted code from executing.","Set PowerShell execution policy to execute only signed scripts.","T1086","[POWERSTATS](https://attack.mitre.org/software/S0223) uses PowerShell for obfuscation and execution.","execution"
"Code Signing","loaded dlls","powershell","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Enforce binary and application integrity with digital signature verification to prevent untrusted code from executing.","Set PowerShell execution policy to execute only signed scripts.","T1086","[POWERSTATS](https://attack.mitre.org/software/S0223) uses PowerShell for obfuscation and execution.","execution"
"Disable or Remove Feature or Program","dll monitoring","component object model and distributed com","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.","Consider disabling DCOM through Dcomcnfg.exe.","T1175","[POWERSTATS](https://attack.mitre.org/software/S0223) can use DCOM (targeting the 127.0.0.1 loopback address) to execute additional payloads on compromised hosts.","execution"
"Disable or Remove Feature or Program","dll monitoring","component object model and distributed com","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.","Consider disabling DCOM through Dcomcnfg.exe.","T1175","[POWERSTATS](https://attack.mitre.org/software/S0223) can use DCOM (targeting the 127.0.0.1 loopback address) to execute additional payloads on compromised hosts.","lateral-movement"
"Disable or Remove Feature or Program","dll monitoring","dynamic data exchange","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.","Registry keys specific to Microsoft Office feature control security can be set to disable automatic DDE/OLE execution. Microsoft also created, and enabled by default, Registry keys to completely disable DDE execution in Word and Excel.","T1173","[POWERSTATS](https://attack.mitre.org/software/S0223) can use DDE to execute additional payloads on compromised hosts.","execution"
"Disable or Remove Feature or Program","dll monitoring","powershell","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.","It may be possible to remove PowerShell from systems when not needed, but a review should be performed to assess the impact to an environment, since it could be in use for many legitimate purposes and administrative functions.\\n\\nDisable/restrict the WinRM Service to help prevent uses of PowerShell for remote execution.","T1086","[POWERSTATS](https://attack.mitre.org/software/S0223) uses PowerShell for obfuscation and execution.","execution"
"Disable or Remove Feature or Program","loaded dlls","powershell","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.","It may be possible to remove PowerShell from systems when not needed, but a review should be performed to assess the impact to an environment, since it could be in use for many legitimate purposes and administrative functions.\\n\\nDisable/restrict the WinRM Service to help prevent uses of PowerShell for remote execution.","T1086","[POWERSTATS](https://attack.mitre.org/software/S0223) uses PowerShell for obfuscation and execution.","execution"
"Disable or Remove Feature or Program","windows event logs","component object model and distributed com","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.","Consider disabling DCOM through Dcomcnfg.exe.","T1175","[POWERSTATS](https://attack.mitre.org/software/S0223) can use DCOM (targeting the 127.0.0.1 loopback address) to execute additional payloads on compromised hosts.","execution"
"Disable or Remove Feature or Program","windows event logs","component object model and distributed com","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.","Consider disabling DCOM through Dcomcnfg.exe.","T1175","[POWERSTATS](https://attack.mitre.org/software/S0223) can use DCOM (targeting the 127.0.0.1 loopback address) to execute additional payloads on compromised hosts.","lateral-movement"
"Disable or Remove Feature or Program","windows event logs","dynamic data exchange","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.","Registry keys specific to Microsoft Office feature control security can be set to disable automatic DDE/OLE execution. Microsoft also created, and enabled by default, Registry keys to completely disable DDE execution in Word and Excel.","T1173","[POWERSTATS](https://attack.mitre.org/software/S0223) can use DDE to execute additional payloads on compromised hosts.","execution"
"Execution Prevention","binary file metadata","masquerading","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Block execution of code on a system through application whitelisting, blacklisting, and/or script blocking.","Use tools that restrict program execution via whitelisting by attributes other than file name for common operating system utilities that are needed.","T1036","[POWERSTATS](https://attack.mitre.org/software/S0223) has created a scheduled task named ""MicrosoftEdge"" to establish persistence.","defense-evasion"
"Network Intrusion Prevention","malware reverse engineering","standard cryptographic protocol","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.","T1032","[POWERSTATS](https://attack.mitre.org/software/S0223) has encrypted C2 traffic with RSA.","command-and-control"
"Network Intrusion Prevention","netflow/enclave netflow","commonly used port","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.","T1043","[POWERSTATS](https://attack.mitre.org/software/S0223) has used port 80 for C2.","command-and-control"
"Network Intrusion Prevention","netflow/enclave netflow","connection proxy","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific C2 protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.","T1090","[POWERSTATS](https://attack.mitre.org/software/S0223) has connected to C2 servers through proxies.","command-and-control"
"Network Intrusion Prevention","netflow/enclave netflow","connection proxy","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific C2 protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.","T1090","[POWERSTATS](https://attack.mitre.org/software/S0223) has connected to C2 servers through proxies.","defense-evasion"
"Network Intrusion Prevention","netflow/enclave netflow","remote file copy","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware or unusual data transfer over known tools and protocols like FTP can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.","T1105","[POWERSTATS](https://attack.mitre.org/software/S0223) can retrieve and execute additional [PowerShell](https://attack.mitre.org/techniques/T1086) payloads from the C2 server.","command-and-control"
"Network Intrusion Prevention","netflow/enclave netflow","remote file copy","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware or unusual data transfer over known tools and protocols like FTP can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.","T1105","[POWERSTATS](https://attack.mitre.org/software/S0223) can retrieve and execute additional [PowerShell](https://attack.mitre.org/techniques/T1086) payloads from the C2 server.","lateral-movement"
"Network Intrusion Prevention","netflow/enclave netflow","scheduled transfer","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary command and control infrastructure and malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool command and control signatures over time or construct protocols in such a way to avoid detection by common defensive tools.","T1029","[POWERSTATS](https://attack.mitre.org/software/S0223) can sleep for a given number of seconds.","exfiltration"
"Network Intrusion Prevention","netflow/enclave netflow","standard cryptographic protocol","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.","T1032","[POWERSTATS](https://attack.mitre.org/software/S0223) has encrypted C2 traffic with RSA.","command-and-control"
"Network Intrusion Prevention","netflow/enclave netflow","uncommonly used port","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.","T1065","[POWERSTATS](https://attack.mitre.org/software/S0223) has used ports 8060 and 8888 for C2.","command-and-control"
"Network Intrusion Prevention","network protocol analysis","data encoding","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.","T1132","[POWERSTATS](https://attack.mitre.org/software/S0223) encoded C2 traffic with base64.","command-and-control"
"Network Intrusion Prevention","network protocol analysis","remote file copy","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware or unusual data transfer over known tools and protocols like FTP can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.","T1105","[POWERSTATS](https://attack.mitre.org/software/S0223) can retrieve and execute additional [PowerShell](https://attack.mitre.org/techniques/T1086) payloads from the C2 server.","command-and-control"
"Network Intrusion Prevention","network protocol analysis","remote file copy","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware or unusual data transfer over known tools and protocols like FTP can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.","T1105","[POWERSTATS](https://attack.mitre.org/software/S0223) can retrieve and execute additional [PowerShell](https://attack.mitre.org/techniques/T1086) payloads from the C2 server.","lateral-movement"
"Network Intrusion Prevention","ssl/tls inspection","standard cryptographic protocol","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.","T1032","[POWERSTATS](https://attack.mitre.org/software/S0223) has encrypted C2 traffic with RSA.","command-and-control"
"Network Segmentation","dll monitoring","component object model and distributed com","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network.","Enable Windows firewall, which prevents DCOM instantiation by default.","T1175","[POWERSTATS](https://attack.mitre.org/software/S0223) can use DCOM (targeting the 127.0.0.1 loopback address) to execute additional payloads on compromised hosts.","execution"
"Network Segmentation","dll monitoring","component object model and distributed com","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network.","Enable Windows firewall, which prevents DCOM instantiation by default.","T1175","[POWERSTATS](https://attack.mitre.org/software/S0223) can use DCOM (targeting the 127.0.0.1 loopback address) to execute additional payloads on compromised hosts.","lateral-movement"
"Network Segmentation","netflow/enclave netflow","commonly used port","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network.","Configure internal and external firewalls to block traffic using common ports that associate to network protocols that may be unnecessary for that particular network segment.","T1043","[POWERSTATS](https://attack.mitre.org/software/S0223) has used port 80 for C2.","command-and-control"
"Network Segmentation","netflow/enclave netflow","uncommonly used port","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network.","Properly configure firewalls and proxies to limit outgoing traffic to only necessary ports for that particular network segment.","T1065","[POWERSTATS](https://attack.mitre.org/software/S0223) has used ports 8060 and 8888 for C2.","command-and-control"
"Network Segmentation","windows event logs","component object model and distributed com","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network.","Enable Windows firewall, which prevents DCOM instantiation by default.","T1175","[POWERSTATS](https://attack.mitre.org/software/S0223) can use DCOM (targeting the 127.0.0.1 loopback address) to execute additional payloads on compromised hosts.","execution"
"Network Segmentation","windows event logs","component object model and distributed com","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network.","Enable Windows firewall, which prevents DCOM instantiation by default.","T1175","[POWERSTATS](https://attack.mitre.org/software/S0223) can use DCOM (targeting the 127.0.0.1 loopback address) to execute additional payloads on compromised hosts.","lateral-movement"
"Operating System Configuration","windows event logs","scheduled task","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.","Configure settings for scheduled tasks to force tasks to run under the context of the authenticated account instead of allowing them to run as SYSTEM. The associated Registry key is located at <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\SubmitControl</code>. The setting can be configured through GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > Security Options: Domain Controller: Allow server operators to schedule tasks, set to disabled.","T1053","[POWERSTATS](https://attack.mitre.org/software/S0223) has established persistence through a scheduled task using the command <code>???C:\Windows\system32\schtasks.exe??? /Create /F /SC DAILY /ST 12:00 /TN MicrosoftEdge /TR ???c:\Windows\system32\wscript.exe C:\Windows\temp\Windows.vbe???</code>.","execution"
"Operating System Configuration","windows event logs","scheduled task","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.","Configure settings for scheduled tasks to force tasks to run under the context of the authenticated account instead of allowing them to run as SYSTEM. The associated Registry key is located at <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\SubmitControl</code>. The setting can be configured through GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > Security Options: Domain Controller: Allow server operators to schedule tasks, set to disabled.","T1053","[POWERSTATS](https://attack.mitre.org/software/S0223) has established persistence through a scheduled task using the command <code>???C:\Windows\system32\schtasks.exe??? /Create /F /SC DAILY /ST 12:00 /TN MicrosoftEdge /TR ???c:\Windows\system32\wscript.exe C:\Windows\temp\Windows.vbe???</code>.","persistence"
"Operating System Configuration","windows event logs","scheduled task","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.","Configure settings for scheduled tasks to force tasks to run under the context of the authenticated account instead of allowing them to run as SYSTEM. The associated Registry key is located at <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\SubmitControl</code>. The setting can be configured through GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > Security Options: Domain Controller: Allow server operators to schedule tasks, set to disabled.","T1053","[POWERSTATS](https://attack.mitre.org/software/S0223) has established persistence through a scheduled task using the command <code>???C:\Windows\system32\schtasks.exe??? /Create /F /SC DAILY /ST 12:00 /TN MicrosoftEdge /TR ???c:\Windows\system32\wscript.exe C:\Windows\temp\Windows.vbe???</code>.","privilege-escalation"
"Privileged Account Management","dll monitoring","component object model and distributed com","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","Modify Registry settings (directly or using Dcomcnfg.exe) in <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\AppID\\{AppID_GUID}</code> associated with the process-wide security of individual COM applications.\\n\\nModify Registry settings (directly or using Dcomcnfg.exe) in <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Ole</code> associated with system-wide security defaults for all COM applications that do no set their own process-wide security.","T1175","[POWERSTATS](https://attack.mitre.org/software/S0223) can use DCOM (targeting the 127.0.0.1 loopback address) to execute additional payloads on compromised hosts.","execution"
"Privileged Account Management","dll monitoring","component object model and distributed com","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","Modify Registry settings (directly or using Dcomcnfg.exe) in <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\AppID\\{AppID_GUID}</code> associated with the process-wide security of individual COM applications.\\n\\nModify Registry settings (directly or using Dcomcnfg.exe) in <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Ole</code> associated with system-wide security defaults for all COM applications that do no set their own process-wide security.","T1175","[POWERSTATS](https://attack.mitre.org/software/S0223) can use DCOM (targeting the 127.0.0.1 loopback address) to execute additional payloads on compromised hosts.","lateral-movement"
"Privileged Account Management","dll monitoring","powershell","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","When PowerShell is necessary, restrict PowerShell execution policy to administrators. Be aware that there are methods of bypassing the PowerShell execution policy, depending on environment configuration.","T1086","[POWERSTATS](https://attack.mitre.org/software/S0223) uses PowerShell for obfuscation and execution.","execution"
"Privileged Account Management","loaded dlls","powershell","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","When PowerShell is necessary, restrict PowerShell execution policy to administrators. Be aware that there are methods of bypassing the PowerShell execution policy, depending on environment configuration.","T1086","[POWERSTATS](https://attack.mitre.org/software/S0223) uses PowerShell for obfuscation and execution.","execution"
"Privileged Account Management","netflow/enclave netflow","windows management instrumentation","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","Prevent credential overlap across systems of administrator and privileged accounts.","T1047","[POWERSTATS](https://attack.mitre.org/software/S0223) can use WMI queries to retrieve data from compromised hosts.","execution"
"Privileged Account Management","windows event logs","component object model and distributed com","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","Modify Registry settings (directly or using Dcomcnfg.exe) in <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\AppID\\{AppID_GUID}</code> associated with the process-wide security of individual COM applications.\\n\\nModify Registry settings (directly or using Dcomcnfg.exe) in <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Ole</code> associated with system-wide security defaults for all COM applications that do no set their own process-wide security.","T1175","[POWERSTATS](https://attack.mitre.org/software/S0223) can use DCOM (targeting the 127.0.0.1 loopback address) to execute additional payloads on compromised hosts.","execution"
"Privileged Account Management","windows event logs","component object model and distributed com","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","Modify Registry settings (directly or using Dcomcnfg.exe) in <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\AppID\\{AppID_GUID}</code> associated with the process-wide security of individual COM applications.\\n\\nModify Registry settings (directly or using Dcomcnfg.exe) in <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Ole</code> associated with system-wide security defaults for all COM applications that do no set their own process-wide security.","T1175","[POWERSTATS](https://attack.mitre.org/software/S0223) can use DCOM (targeting the 127.0.0.1 loopback address) to execute additional payloads on compromised hosts.","lateral-movement"
"Privileged Account Management","windows event logs","scheduled task","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","Configure the Increase Scheduling Priority option to only allow the Administrators group the rights to schedule a priority process. This can be can be configured through GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Increase scheduling priority.","T1053","[POWERSTATS](https://attack.mitre.org/software/S0223) has established persistence through a scheduled task using the command <code>???C:\Windows\system32\schtasks.exe??? /Create /F /SC DAILY /ST 12:00 /TN MicrosoftEdge /TR ???c:\Windows\system32\wscript.exe C:\Windows\temp\Windows.vbe???</code>.","execution"
"Privileged Account Management","windows event logs","scheduled task","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","Configure the Increase Scheduling Priority option to only allow the Administrators group the rights to schedule a priority process. This can be can be configured through GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Increase scheduling priority.","T1053","[POWERSTATS](https://attack.mitre.org/software/S0223) has established persistence through a scheduled task using the command <code>???C:\Windows\system32\schtasks.exe??? /Create /F /SC DAILY /ST 12:00 /TN MicrosoftEdge /TR ???c:\Windows\system32\wscript.exe C:\Windows\temp\Windows.vbe???</code>.","persistence"
"Privileged Account Management","windows event logs","scheduled task","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.","Configure the Increase Scheduling Priority option to only allow the Administrators group the rights to schedule a priority process. This can be can be configured through GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Increase scheduling priority.","T1053","[POWERSTATS](https://attack.mitre.org/software/S0223) has established persistence through a scheduled task using the command <code>???C:\Windows\system32\schtasks.exe??? /Create /F /SC DAILY /ST 12:00 /TN MicrosoftEdge /TR ???c:\Windows\system32\wscript.exe C:\Windows\temp\Windows.vbe???</code>.","privilege-escalation"
"Restrict File and Directory Permissions","anti-virus","disabling security tools","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Restrict access by setting directory and file permissions that are not specific to users or privileged accounts.","Ensure proper process, Registry, and file permissions are in place to prevent adversaries from disabling or interfering with security services.","T1089","[POWERSTATS](https://attack.mitre.org/software/S0223) can disable Microsoft Office Protected View by changing Registry keys.","defense-evasion"
"Restrict File and Directory Permissions","binary file metadata","masquerading","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Restrict access by setting directory and file permissions that are not specific to users or privileged accounts.","Use file system access controls to protect folders such as C:\\Windows\\System32.","T1036","[POWERSTATS](https://attack.mitre.org/software/S0223) has created a scheduled task named ""MicrosoftEdge"" to establish persistence.","defense-evasion"
"Software Configuration","dll monitoring","dynamic data exchange","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Implement configuration changes to software (other than the operating system) to mitigate security risks associated to how the software operates.","Consider disabling embedded files in Office programs, such as OneNote, that do not work with Protected View.","T1173","[POWERSTATS](https://attack.mitre.org/software/S0223) can use DDE to execute additional payloads on compromised hosts.","execution"
"Software Configuration","windows event logs","dynamic data exchange","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Implement configuration changes to software (other than the operating system) to mitigate security risks associated to how the software operates.","Consider disabling embedded files in Office programs, such as OneNote, that do not work with Protected View.","T1173","[POWERSTATS](https://attack.mitre.org/software/S0223) can use DDE to execute additional payloads on compromised hosts.","execution"
"SSL/TLS Inspection","malware reverse engineering","standard cryptographic protocol","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Break and inspect SSL/TLS sessions to look at encrypted web traffic for adversary activity.","SSL/TLS inspection can be used to see the contents of encrypted sessions to look for network-based indicators of malware communication protocols.","T1032","[POWERSTATS](https://attack.mitre.org/software/S0223) has encrypted C2 traffic with RSA.","command-and-control"
"SSL/TLS Inspection","netflow/enclave netflow","standard cryptographic protocol","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Break and inspect SSL/TLS sessions to look at encrypted web traffic for adversary activity.","SSL/TLS inspection can be used to see the contents of encrypted sessions to look for network-based indicators of malware communication protocols.","T1032","[POWERSTATS](https://attack.mitre.org/software/S0223) has encrypted C2 traffic with RSA.","command-and-control"
"SSL/TLS Inspection","ssl/tls inspection","standard cryptographic protocol","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Break and inspect SSL/TLS sessions to look at encrypted web traffic for adversary activity.","SSL/TLS inspection can be used to see the contents of encrypted sessions to look for network-based indicators of malware communication protocols.","T1032","[POWERSTATS](https://attack.mitre.org/software/S0223) has encrypted C2 traffic with RSA.","command-and-control"
"User Account Management","anti-virus","disabling security tools","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Manage the creation, modification, use, and permissions associated to user accounts.","Ensure proper user permissions are in place to prevent adversaries from disabling or interfering with security services.","T1089","[POWERSTATS](https://attack.mitre.org/software/S0223) can disable Microsoft Office Protected View by changing Registry keys.","defense-evasion"
"User Account Management","netflow/enclave netflow","windows management instrumentation","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Manage the creation, modification, use, and permissions associated to user accounts.","By default, only administrators are allowed to connect remotely using WMI. Restrict other users who are allowed to connect, or disallow all users to connect remotely to WMI.","T1047","[POWERSTATS](https://attack.mitre.org/software/S0223) can use WMI queries to retrieve data from compromised hosts.","execution"
"User Account Management","windows event logs","scheduled task","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Manage the creation, modification, use, and permissions associated to user accounts.","Limit privileges of user accounts and remediate Privilege Escalation vectors so only authorized administrators can create scheduled tasks on remote systems.","T1053","[POWERSTATS](https://attack.mitre.org/software/S0223) has established persistence through a scheduled task using the command <code>???C:\Windows\system32\schtasks.exe??? /Create /F /SC DAILY /ST 12:00 /TN MicrosoftEdge /TR ???c:\Windows\system32\wscript.exe C:\Windows\temp\Windows.vbe???</code>.","execution"
"User Account Management","windows event logs","scheduled task","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Manage the creation, modification, use, and permissions associated to user accounts.","Limit privileges of user accounts and remediate Privilege Escalation vectors so only authorized administrators can create scheduled tasks on remote systems.","T1053","[POWERSTATS](https://attack.mitre.org/software/S0223) has established persistence through a scheduled task using the command <code>???C:\Windows\system32\schtasks.exe??? /Create /F /SC DAILY /ST 12:00 /TN MicrosoftEdge /TR ???c:\Windows\system32\wscript.exe C:\Windows\temp\Windows.vbe???</code>.","persistence"
"User Account Management","windows event logs","scheduled task","POWERSTATS","[POWERSTATS](https://attack.mitre.org/software/S0223) is a PowerShell-based first stage backdoor used by [MuddyWater](https://attack.mitre.org/groups/G0069). (Citation: Unit 42 MuddyWater Nov 2017)","Manage the creation, modification, use, and permissions associated to user accounts.","Limit privileges of user accounts and remediate Privilege Escalation vectors so only authorized administrators can create scheduled tasks on remote systems.","T1053","[POWERSTATS](https://attack.mitre.org/software/S0223) has established persistence through a scheduled task using the command <code>???C:\Windows\system32\schtasks.exe??? /Create /F /SC DAILY /ST 12:00 /TN MicrosoftEdge /TR ???c:\Windows\system32\wscript.exe C:\Windows\temp\Windows.vbe???</code>.","privilege-escalation"
