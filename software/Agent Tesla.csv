"Mitigation Name","data source","technique","Software Name","Software Description","Mitigation Description","Application","TID","Use","tactic"
"Antivirus/Antimalware","binary file metadata","obfuscated files or information","Agent Tesla","[Agent Tesla](https://attack.mitre.org/software/S0331) is a spyware Trojan written in visual basic.(Citation: Fortinet Agent Tesla April 2018)","Use signatures or heuristics to detect malicious software.","Consider utilizing the Antimalware Scan Interface (AMSI) on Windows 10 to analyze commands after being processed/interpreted.","T1027","[Agent Tesla](https://attack.mitre.org/software/S0331) obfuscates its code in an apparent attempt to make analysis difficult.","defense-evasion"
"Antivirus/Antimalware","malware reverse engineering","obfuscated files or information","Agent Tesla","[Agent Tesla](https://attack.mitre.org/software/S0331) is a spyware Trojan written in visual basic.(Citation: Fortinet Agent Tesla April 2018)","Use signatures or heuristics to detect malicious software.","Consider utilizing the Antimalware Scan Interface (AMSI) on Windows 10 to analyze commands after being processed/interpreted.","T1027","[Agent Tesla](https://attack.mitre.org/software/S0331) obfuscates its code in an apparent attempt to make analysis difficult.","defense-evasion"
"Antivirus/Antimalware","network intrusion detection system","obfuscated files or information","Agent Tesla","[Agent Tesla](https://attack.mitre.org/software/S0331) is a spyware Trojan written in visual basic.(Citation: Fortinet Agent Tesla April 2018)","Use signatures or heuristics to detect malicious software.","Consider utilizing the Antimalware Scan Interface (AMSI) on Windows 10 to analyze commands after being processed/interpreted.","T1027","[Agent Tesla](https://attack.mitre.org/software/S0331) obfuscates its code in an apparent attempt to make analysis difficult.","defense-evasion"
"Antivirus/Antimalware","network protocol analysis","obfuscated files or information","Agent Tesla","[Agent Tesla](https://attack.mitre.org/software/S0331) is a spyware Trojan written in visual basic.(Citation: Fortinet Agent Tesla April 2018)","Use signatures or heuristics to detect malicious software.","Consider utilizing the Antimalware Scan Interface (AMSI) on Windows 10 to analyze commands after being processed/interpreted.","T1027","[Agent Tesla](https://attack.mitre.org/software/S0331) obfuscates its code in an apparent attempt to make analysis difficult.","defense-evasion"
"Antivirus/Antimalware","ssl/tls inspection","obfuscated files or information","Agent Tesla","[Agent Tesla](https://attack.mitre.org/software/S0331) is a spyware Trojan written in visual basic.(Citation: Fortinet Agent Tesla April 2018)","Use signatures or heuristics to detect malicious software.","Consider utilizing the Antimalware Scan Interface (AMSI) on Windows 10 to analyze commands after being processed/interpreted.","T1027","[Agent Tesla](https://attack.mitre.org/software/S0331) obfuscates its code in an apparent attempt to make analysis difficult.","defense-evasion"
"Antivirus/Antimalware","windows event logs","obfuscated files or information","Agent Tesla","[Agent Tesla](https://attack.mitre.org/software/S0331) is a spyware Trojan written in visual basic.(Citation: Fortinet Agent Tesla April 2018)","Use signatures or heuristics to detect malicious software.","Consider utilizing the Antimalware Scan Interface (AMSI) on Windows 10 to analyze commands after being processed/interpreted.","T1027","[Agent Tesla](https://attack.mitre.org/software/S0331) obfuscates its code in an apparent attempt to make analysis difficult.","defense-evasion"
"Application Isolation and Sandboxing","anti-virus","exploitation for client execution","Agent Tesla","[Agent Tesla](https://attack.mitre.org/software/S0331) is a spyware Trojan written in visual basic.(Citation: Fortinet Agent Tesla April 2018)","Restrict execution of code to a virtual environment on or in transit to an endpoint system.","Browser sandboxes can be used to mitigate some of the impact of exploitation, but sandbox escapes may still exist.\\n\\nOther types of virtualization and application microsegmentation may also mitigate the impact of client-side exploitation. Risks of additional exploits and weaknesses in those systems may still exist.","T1203","[Agent Tesla](https://attack.mitre.org/software/S0331) exploits CVE-2017-11882 in Microsoft???s Equation Editor to execute a process.","execution"
"Application Isolation and Sandboxing","system calls","exploitation for client execution","Agent Tesla","[Agent Tesla](https://attack.mitre.org/software/S0331) is a spyware Trojan written in visual basic.(Citation: Fortinet Agent Tesla April 2018)","Restrict execution of code to a virtual environment on or in transit to an endpoint system.","Browser sandboxes can be used to mitigate some of the impact of exploitation, but sandbox escapes may still exist.\\n\\nOther types of virtualization and application microsegmentation may also mitigate the impact of client-side exploitation. Risks of additional exploits and weaknesses in those systems may still exist.","T1203","[Agent Tesla](https://attack.mitre.org/software/S0331) exploits CVE-2017-11882 in Microsoft???s Equation Editor to execute a process.","execution"
"Exploit Protection","anti-virus","exploitation for client execution","Agent Tesla","[Agent Tesla](https://attack.mitre.org/software/S0331) is a spyware Trojan written in visual basic.(Citation: Fortinet Agent Tesla April 2018)","Use capabilities to detect and block conditions that may lead to or be indicative of a software exploit occurring.","Security applications that look for behavior used during exploitation such as Windows Defender Exploit Guard (WDEG) and the Enhanced Mitigation Experience Toolkit (EMET) can be used to mitigate some exploitation behavior. Control flow integrity checking is another way to potentially identify and stop a software exploit from occurring. Many of these protections depend on the architecture and target application binary for compatibility.","T1203","[Agent Tesla](https://attack.mitre.org/software/S0331) exploits CVE-2017-11882 in Microsoft???s Equation Editor to execute a process.","execution"
"Exploit Protection","system calls","exploitation for client execution","Agent Tesla","[Agent Tesla](https://attack.mitre.org/software/S0331) is a spyware Trojan written in visual basic.(Citation: Fortinet Agent Tesla April 2018)","Use capabilities to detect and block conditions that may lead to or be indicative of a software exploit occurring.","Security applications that look for behavior used during exploitation such as Windows Defender Exploit Guard (WDEG) and the Enhanced Mitigation Experience Toolkit (EMET) can be used to mitigate some exploitation behavior. Control flow integrity checking is another way to potentially identify and stop a software exploit from occurring. Many of these protections depend on the architecture and target application binary for compatibility.","T1203","[Agent Tesla](https://attack.mitre.org/software/S0331) exploits CVE-2017-11882 in Microsoft???s Equation Editor to execute a process.","execution"
"Filter Network Traffic","netflow/enclave netflow","exfiltration over alternative protocol","Agent Tesla","[Agent Tesla](https://attack.mitre.org/software/S0331) is a spyware Trojan written in visual basic.(Citation: Fortinet Agent Tesla April 2018)","Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.","Enforce proxies and use dedicated servers for services such as DNS and only allow those systems to communicate over respective ports/protocols, instead of all systems within a network.","T1048","[Agent Tesla](https://attack.mitre.org/software/S0331) has routines for exfiltration over SMTP, FTP, and HTTP.","exfiltration"
"Filter Network Traffic","network protocol analysis","exfiltration over alternative protocol","Agent Tesla","[Agent Tesla](https://attack.mitre.org/software/S0331) is a spyware Trojan written in visual basic.(Citation: Fortinet Agent Tesla April 2018)","Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.","Enforce proxies and use dedicated servers for services such as DNS and only allow those systems to communicate over respective ports/protocols, instead of all systems within a network.","T1048","[Agent Tesla](https://attack.mitre.org/software/S0331) has routines for exfiltration over SMTP, FTP, and HTTP.","exfiltration"
"Network Intrusion Prevention","malware reverse engineering","standard application layer protocol","Agent Tesla","[Agent Tesla](https://attack.mitre.org/software/S0331) is a spyware Trojan written in visual basic.(Citation: Fortinet Agent Tesla April 2018)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.","T1071","[Agent Tesla](https://attack.mitre.org/software/S0331) has used HTTP and SMTP for C2 communications.","command-and-control"
"Network Intrusion Prevention","netflow/enclave netflow","exfiltration over alternative protocol","Agent Tesla","[Agent Tesla](https://attack.mitre.org/software/S0331) is a spyware Trojan written in visual basic.(Citation: Fortinet Agent Tesla April 2018)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary command and control infrastructure and malware can be used to mitigate activity at the network level.","T1048","[Agent Tesla](https://attack.mitre.org/software/S0331) has routines for exfiltration over SMTP, FTP, and HTTP.","exfiltration"
"Network Intrusion Prevention","netflow/enclave netflow","remote file copy","Agent Tesla","[Agent Tesla](https://attack.mitre.org/software/S0331) is a spyware Trojan written in visual basic.(Citation: Fortinet Agent Tesla April 2018)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware or unusual data transfer over known tools and protocols like FTP can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.","T1105","[Agent Tesla](https://attack.mitre.org/software/S0331) can download additional files for execution on the victim???s machine.","command-and-control"
"Network Intrusion Prevention","netflow/enclave netflow","remote file copy","Agent Tesla","[Agent Tesla](https://attack.mitre.org/software/S0331) is a spyware Trojan written in visual basic.(Citation: Fortinet Agent Tesla April 2018)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware or unusual data transfer over known tools and protocols like FTP can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.","T1105","[Agent Tesla](https://attack.mitre.org/software/S0331) can download additional files for execution on the victim???s machine.","lateral-movement"
"Network Intrusion Prevention","netflow/enclave netflow","standard application layer protocol","Agent Tesla","[Agent Tesla](https://attack.mitre.org/software/S0331) is a spyware Trojan written in visual basic.(Citation: Fortinet Agent Tesla April 2018)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.","T1071","[Agent Tesla](https://attack.mitre.org/software/S0331) has used HTTP and SMTP for C2 communications.","command-and-control"
"Network Intrusion Prevention","netflow/enclave netflow","uncommonly used port","Agent Tesla","[Agent Tesla](https://attack.mitre.org/software/S0331) is a spyware Trojan written in visual basic.(Citation: Fortinet Agent Tesla April 2018)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.","T1065","[Agent Tesla](https://attack.mitre.org/software/S0331) has enabled TCP on port 587 for C2 communications.","command-and-control"
"Network Intrusion Prevention","network protocol analysis","exfiltration over alternative protocol","Agent Tesla","[Agent Tesla](https://attack.mitre.org/software/S0331) is a spyware Trojan written in visual basic.(Citation: Fortinet Agent Tesla April 2018)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary command and control infrastructure and malware can be used to mitigate activity at the network level.","T1048","[Agent Tesla](https://attack.mitre.org/software/S0331) has routines for exfiltration over SMTP, FTP, and HTTP.","exfiltration"
"Network Intrusion Prevention","network protocol analysis","remote file copy","Agent Tesla","[Agent Tesla](https://attack.mitre.org/software/S0331) is a spyware Trojan written in visual basic.(Citation: Fortinet Agent Tesla April 2018)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware or unusual data transfer over known tools and protocols like FTP can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.","T1105","[Agent Tesla](https://attack.mitre.org/software/S0331) can download additional files for execution on the victim???s machine.","command-and-control"
"Network Intrusion Prevention","network protocol analysis","remote file copy","Agent Tesla","[Agent Tesla](https://attack.mitre.org/software/S0331) is a spyware Trojan written in visual basic.(Citation: Fortinet Agent Tesla April 2018)","Use intrusion detection signatures to block traffic at network boundaries.","Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware or unusual data transfer over known tools and protocols like FTP can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.","T1105","[Agent Tesla](https://attack.mitre.org/software/S0331) can download additional files for execution on the victim???s machine.","lateral-movement"
"Network Segmentation","netflow/enclave netflow","exfiltration over alternative protocol","Agent Tesla","[Agent Tesla](https://attack.mitre.org/software/S0331) is a spyware Trojan written in visual basic.(Citation: Fortinet Agent Tesla April 2018)","Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network.","Follow best practices for network firewall configurations to allow only necessary ports and traffic to enter and exit the network.","T1048","[Agent Tesla](https://attack.mitre.org/software/S0331) has routines for exfiltration over SMTP, FTP, and HTTP.","exfiltration"
"Network Segmentation","netflow/enclave netflow","uncommonly used port","Agent Tesla","[Agent Tesla](https://attack.mitre.org/software/S0331) is a spyware Trojan written in visual basic.(Citation: Fortinet Agent Tesla April 2018)","Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network.","Properly configure firewalls and proxies to limit outgoing traffic to only necessary ports for that particular network segment.","T1065","[Agent Tesla](https://attack.mitre.org/software/S0331) has enabled TCP on port 587 for C2 communications.","command-and-control"
"Network Segmentation","network protocol analysis","exfiltration over alternative protocol","Agent Tesla","[Agent Tesla](https://attack.mitre.org/software/S0331) is a spyware Trojan written in visual basic.(Citation: Fortinet Agent Tesla April 2018)","Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network.","Follow best practices for network firewall configurations to allow only necessary ports and traffic to enter and exit the network.","T1048","[Agent Tesla](https://attack.mitre.org/software/S0331) has routines for exfiltration over SMTP, FTP, and HTTP.","exfiltration"
"Restrict File and Directory Permissions","anti-virus","disabling security tools","Agent Tesla","[Agent Tesla](https://attack.mitre.org/software/S0331) is a spyware Trojan written in visual basic.(Citation: Fortinet Agent Tesla April 2018)","Restrict access by setting directory and file permissions that are not specific to users or privileged accounts.","Ensure proper process, Registry, and file permissions are in place to prevent adversaries from disabling or interfering with security services.","T1089","[Agent Tesla](https://attack.mitre.org/software/S0331) has the capability to kill any running analysis processes and AV software.","defense-evasion"
"User Account Management","anti-virus","disabling security tools","Agent Tesla","[Agent Tesla](https://attack.mitre.org/software/S0331) is a spyware Trojan written in visual basic.(Citation: Fortinet Agent Tesla April 2018)","Manage the creation, modification, use, and permissions associated to user accounts.","Ensure proper user permissions are in place to prevent adversaries from disabling or interfering with security services.","T1089","[Agent Tesla](https://attack.mitre.org/software/S0331) has the capability to kill any running analysis processes and AV software.","defense-evasion"
